<html>
    <script src="index.js"></script>
    <script src="search.js"></script>
    <script src="account.js"></script>
    <script src="settings.js"></script>
    <script src="route.js"></script>
    <script src="favorites.js"></script>
    <link rel="stylesheet" type="text/css" href="index.css">
    <head>
        <title>Meet Up</title>
    </head>
    <body>
        <div id="fullscreen">
            <div id="map"></div>
            <input id="search" placeholder="Search"/>
            <button id="btn" onclick="onSearch()">Search</button>
        </div>
        <button id="menu" onclick="onSettings()">Settings</button>
        <div id="menu_top">
            <div class="center" id="settings" style="text-align: center;">
                <button id="login_btn" class="g-signin2" data-onsuccess="onSignIn">Login</button>
                <button id="logout_btn" onclick="signOut()">Signout</button>
                <div id="contenta">
                    <a class="set_heading">Avoid Highways<label class="switch">
                        <input type="checkbox" id="highways">
                        <span class="slider round"></span>
                    </label></a>
                    <a class="set_heading">Avoid Tolls<label class="switch">
                        <input type="checkbox" id="tolls">
                        <span class="slider round"></span>
                    </label></a>
                    <a class="set_heading">Avoid Ferries<label class="switch">
                        <input type="checkbox" id="ferries">
                        <span class="slider round"></span>
                    </label></a>
                </div>
                <button id="dn_btn" onclick="onSettings()">Done</button>
            </div>
        </div>
        <script>
            function onLoad (){
                document.getElementById("settings").style.display = 'none';
                document.getElementById("logout_btn").style.display = 'none';
                home = new Index;
                home.loadmap();
            }

            function onSearch (){
                var currentUser = gapi.auth2.getAuthInstance().currentUser.je.Pt;
                if (currentUser){
                    search = new Search(document.getElementById("search").value);
                }else{
                    alert("Please Sign in!")
                    onSettings();
                }
            }

            function onSelection (geo){
                console.log(acc.email+"\nMy Location: "+home.geopos.lat+" : "+home.geopos.lng+"\nDestination: "+geo.lat+" : "+geo.lng);
                route = new Route(geo);
            }

            function toFav(location){
                favs.add_new(location);
            }

            function letsGo(route){
                console.log(route);
                alert("lets go");
            }

            function onSettings (){
                var settings = document.getElementById("settings").style.display;
                if (settings == ''){
                    document.getElementById("settings").style.display = 'none';
                    document.getElementById("map").style.filter = ""
                    next = new Settings();
                    next.save_settings();
                    alert("Re-routing")
                }else{
                    document.getElementById("map").style.filter = "blur(3px)"
                    document.getElementById("settings").style.display = '';
                }
            }

            function onSignIn(googleUser) {
                if (googleUser){
                    acc = new Account(googleUser);
                    acc.configSettings();
                    favs = new Favorites();
                    favs.add_to_maps(googleUser,home.map);
                    document.getElementById("login_btn").style.display = 'none';
                    document.getElementById("logout_btn").value = googleUser.Pt["Ad"]+" - Signout";
                    document.getElementById("logout_btn").style.display = '';
                }else{
                    alert("Authorization Failed!");
                }
            }

            function signOut() {
                var googleObj = gapi.auth2.getAuthInstance();
                var name = googleObj.currentUser.je["Pt"]["Ad"];
                googleObj.signOut().then(function () {
                    alert(name+' signed out.');
                    document.getElementById("logout_btn").style.display = 'none';
                    document.getElementById("login_btn").style.display = '';
                });
            }
        </script>
        <script src="https://apis.google.com/js/platform.js" async defer></script>
        <meta name="google-signin-client_id" content="945662824135-ig4027d81ifpcd84igq1hls3nbjk3035.apps.googleusercontent.com">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDYUzQtSil29MmByyGmVeoIzcM80HznRTA&libraries=geometry&callback=onLoad"
        async defer></script>
    </body>

</html>

<!-- npx reload -b -->